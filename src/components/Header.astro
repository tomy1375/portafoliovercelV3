---
import Hero from "./Hero.astro"
import HomeIcons from "../components/icons/HomeIcons.astro"
import Person from "../components/icons/Person.astro"
import ExperienciaIcon from "../components/icons/ExperienciaIcon.astro"
import ProyectoIcon from "../components/icons/ProyectosIcon.astro"
import TecnologiasIcon from "../components/icons/TecnologiasIcon.astro"
import ContactoIcon from "../components/icons/ContactoIcon.astro"
---

<div data-layername="landingpage" id="inicio" class="flex overflow-hidden flex-col bg-neutral-900 w-screen h-screen">
  <header class="flex relative flex-col justify-center">
    <img loading="lazy" src="/escritorio4.webp" alt="" class="absolute inset-0 object-cover w-screen h-screen" />
    <div id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
      <div class="flex relative flex-col items-center px-20 pt-10 w-screen max-md:px-5 max-md:max-w-full">
        <div class="bg-black bg-opacity-50 rounded-full px-6 py-3 transition-all duration-300">
          <!-- Navbar para escritorio -->
          <nav data-layername="navbarButton" class="hidden md:flex flex-wrap justify-center gap-6 items-center max-w-full text-base text-white opacity-80">
            <a href="#inicio" class="btnd group">
              <HomeIcons className="w-4 h-4 mr-1 group-hover:filter transition-all duration-300" />
              <span class="transition-all duration-300">Inicio</span>
            </a>
            <a href="#sobreMi" class="btnd group">
              <Person class="object-contain z-10 self-start mt-0 aspect-square w-[30px] inline-block mr-1 group-hover:filter group-hover:brightness-125 transition-all duration-300" />
              <span class="transition-all duration-300">Sobre mí</span>
            </a>
            <a href="#experiencia" class="btnd group">
              <ExperienciaIcon className="w-9 h-9 mr-1 group-hover:filter transition-all duration-300"/>
              <span class="transition-all duration-300">Experiencia</span>
            </a>
            <a href="#proyectos" class="btnd group">
              <ProyectoIcon className="w-9 h-9 mr-1 group-hover:filter transition-all duration-300"/>
              <span class="transition-all duration-300">Proyectos</span>
            </a>
            <a href="#tecnologias" class="btnd group">
              <TecnologiasIcon/>
              <span class="transition-all duration-300">Tecnologías</span>
            </a>
            <a href="#contacto" class="btnd group">
              <ContactoIcon/>
              <span class="transition-all duration-300">Contacto</span>
            </a>
          </nav>
          
          <!-- Botón de hamburguesa para móvil -->
          <button id="mobile-menu-button" class="md:hidden flex items-center justify-center w-10 h-10 text-white focus:outline-none">
            <div class="hamburger-icon">
              <span class="line line-1"></span>
              <span class="line line-2"></span>
              <span class="line line-3"></span>
            </div>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Menú móvil -->
    <div id="mobile-menu" class="fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-95 transform scale-0 opacity-0 pointer-events-none transition-all duration-500">
      <div class="mobile-menu-content transform translate-y-8 opacity-0 transition-all duration-500 delay-100">
        <nav class="flex flex-col items-center gap-8 text-xl text-white">
          <a href="#inicio" class="mobile-nav-item group flex items-center">
            <HomeIcons className="w-5 h-5 mr-2 group-hover:filter transition-all duration-300" />
            <span>Inicio</span>
          </a>
          <a href="#sobreMi" class="mobile-nav-item group flex items-center">
            <Person class="w-6 h-6 mr-2 group-hover:filter group-hover:brightness-125 transition-all duration-300" />
            <span>Sobre mí</span>
          </a>
          <a href="#experiencia" class="mobile-nav-item group flex items-center">
            <ExperienciaIcon className="w-6 h-6 mr-2 group-hover:filter transition-all duration-300"/>
            <span>Experiencia</span>
          </a>
          <a href="#proyectos" class="mobile-nav-item group flex items-center">
            <ProyectoIcon className="w-6 h-6 mr-2 group-hover:filter transition-all duration-300"/>
            <span>Proyectos</span>
          </a>
          <a href="#tecnologias" class="mobile-nav-item group flex items-center">
            <TecnologiasIcon className="w-6 h-6 mr-2"/>
            <span>Tecnologías</span>
          </a>
          <a href="#contacto" class="mobile-nav-item group flex items-center">
            <ContactoIcon className="w-6 h-6 mr-2"/>
            <span>Contacto</span>
          </a>
        </nav>
      </div>
    </div>
    
    <div class="flex flex-col items-center m justify-center mb-0 max-w-full w-[790px] max-md:mb-2.5 opacity-90 mx-auto mt-40">
      <div>
        <Hero/>
      </div>
    </div>
  </header>
</div>

<style>
  /* Estilos existentes */
  .btnd {
    font-size: 16px;
    background: transparent;
    border: none;
    padding: 0.2em 0.4em;
    margin: 0 0.2em;
    color: #ffffff;
    position: relative;
    transition: 0.5s ease;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .btnd::before {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    height: 2px;
    width: 100%; 
    background-color: #fcd34d;
    transition: 0.5s ease;
    transform: scaleX(0); 
  }

  .btnd:hover {
    color: #fcd34d;
    transition-delay: 0.1s;
  }

  .btnd:hover::before {
    transform: scaleX(1); 
  }

  .btnd:hover img {
    filter: brightness(125%);
  }

  nav:hover .btnd:not(:hover) {
    opacity: 0.5;
    transition: opacity 0.3s ease;
  }

  .background {
    height: 300px;
  }

  @media (max-width: 768px) {
    .btnd {
      font-size: 14px;
      padding: 0.1em 0.3em;
    }
  }

  .navbar-scrolled {
    background-color: rgba(0, 0, 0, 0.8);
    padding-bottom: 0.5rem;
  }

  .navbar-scrolled .btnd {
    font-size: 14px;
  }

  .navbar-scrolled img,
  .navbar-scrolled :global(svg) {
    width: 24px;
    height: 24px;
  }
  
  /* Estilos para el botón de hamburguesa */
  .hamburger-icon {
    position: relative;
    width: 24px;
    height: 18px;
  }
  
  .line {
    position: absolute;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: white;
    transition: all 0.3s ease;
  }
  
  .line-1 {
    top: 0;
  }
  
  .line-2 {
    top: 8px;
  }
  
  .line-3 {
    bottom: 0;
  }
  
  /* Animación del botón de hamburguesa */
  .open .line-1 {
    transform: translateY(8px) rotate(45deg);
    background-color: #fcd34d;
  }
  
  .open .line-2 {
    opacity: 0;
  }
  
  .open .line-3 {
    transform: translateY(-8px) rotate(-45deg);
    background-color: #fcd34d;
  }
  
  /* Estilos para el menú móvil */
  .mobile-nav-item {
    position: relative;
    padding: 0.5rem 1rem;
    transition: color 0.3s ease;
  }
  
  .mobile-nav-item::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 50%;
    width: 0;
    height: 2px;
    background-color: #fcd34d;
    transition: all 0.3s ease;
    transform: translateX(-50%);
  }
  
  .mobile-nav-item:hover {
    color: #fcd34d;
  }
  
  .mobile-nav-item:hover::after {
    width: 80%;
  }
  
  /* Clase para cuando el menú está abierto */
  .menu-open {
    transform: scale(1) !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }
  
  /* Clase para la animación del contenido del menú */
  .content-visible {
    transform: translateY(0) !important;
    opacity: 1 !important;
  }
  
  /* Clase para el elemento activo */
  .active-link {
    color: #fcd34d;
  }
  
  .active-link::after {
    width: 80%;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const navbar = document.getElementById('navbar');
    const navLinks = document.querySelectorAll('.btnd, .mobile-nav-item');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileMenuContent = document.querySelector('.mobile-menu-content');
    const hamburgerIcon = document.querySelector('.hamburger-icon');
    const body = document.body;
    
    // Función para abrir/cerrar el menú móvil
    function toggleMobileMenu() {
      if (mobileMenu?.classList.contains('menu-open')) {
        // Cerrar menú
        mobileMenu.classList.remove('menu-open');
        mobileMenuContent?.classList.remove('content-visible');
        hamburgerIcon?.classList.remove('open');
        body.style.overflow = ''; // Restaurar scroll
      } else {
        // Abrir menú
        mobileMenu?.classList.add('menu-open');
        setTimeout(() => {
          mobileMenuContent?.classList.add('content-visible');
        }, 100);
        hamburgerIcon?.classList.add('open');
        body.style.overflow = 'hidden'; // Prevenir scroll
      }
    }
    
    // Event listener para el botón de menú móvil
    mobileMenuButton?.addEventListener('click', toggleMobileMenu);
    
    // Cerrar el menú al hacer clic en un enlace
    const mobileNavItems = document.querySelectorAll('.mobile-nav-item');
    mobileNavItems.forEach((item: Element) => {
      item.addEventListener('click', () => {
        toggleMobileMenu();
      });
    });

    // Cambiar estilo del navbar al hacer scroll
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        navbar?.classList.add('navbar-scrolled');
      } else {
        navbar?.classList.remove('navbar-scrolled');
      }
    });

    // Navegación suave al hacer clic en los enlaces
    navLinks.forEach((link: Element) => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const href = link.getAttribute('href');
        if (href) {
          const targetId = href.substring(1);
          const targetElement = document.getElementById(targetId);
          
          if (targetElement) {
            targetElement.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        }
      });
    });

    // Observer para detectar la sección activa
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.id;
          // Actualizar enlaces de escritorio
          const desktopLink = document.querySelector(`.btnd[href="#${id}"]`);
          if (desktopLink) {
            navLinks.forEach(link => {
              if (link.classList.contains('btnd')) {
                link.classList.remove('text-fcd34d');
              }
            });
            desktopLink.classList.add('text-fcd34d');
          }
          
          // Actualizar enlaces móviles
          const mobileLink = document.querySelector(`.mobile-nav-item[href="#${id}"]`);
          if (mobileLink) {
            mobileNavItems.forEach(link => {
              link.classList.remove('active-link');
            });
            mobileLink.classList.add('active-link');
          }
        }
      });
    }, { threshold: 0.5 });

    document.querySelectorAll('section[id], div[id="inicio"]').forEach((section) => {
      observer.observe(section);
    });
  });
</script>